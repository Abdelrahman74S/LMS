{% extends "base.html" %}

{% block content %}

<div class="container mt-4">
  <div class="row">
    <div class="col-md-4">
      {% if book.image %}
        <img src="{{ book.image.url }}" alt="{{ book.title }}" class="img-fluid rounded shadow">
      {% endif %}
    </div>

    <div class="col-md-8">
      <h1>{{ book.title }}</h1>
      <p><strong>Author:</strong> {{ book.author }}</p>
      <p><strong>Category:</strong> {{ book.category.name }}</p>
      <p><strong>Description:</strong> {{ book.description }}</p>
      <p><strong>Available copies:</strong> {{ book.copies_available }}</p>
      <p><strong>Price:</strong> {{ book.price }} $</p>
      <p><strong>From:</strong> {{ book.owner }} </p>

      {% if book.pdf %}
      
      {% if user.account_type == "seller" and  book.owner == user %}
      <a href="{% url 'Library:update_book' book.pk%}" class="btn btn-outline-secondary">update</a>
                   
              <form method="post" action="{% url 'Library:delete_book' book.pk %}" style="display:inline;">
                {% csrf_token %}
                <button type="submit" class="btn btn-outline-danger">Delete</button>
              </form>
              
      {% endif %}

      
      {% if  book.owner != user %}
        {% if book.copies_available > 0 %}
    {% if user_has_borrowed_book %}
        <p class="text-muted">You have already borrowed this book.</p>
    {% else %}
        <form action="{% url 'Library:create_borrowing' book_pk=book.pk %}" method="POST" class="d-inline">
            {% csrf_token %}
            <button type="submit" class="btn btn-success">Borrow Now </button>
        </form>
    {% endif %}
{% else %}
    <p class="text-danger">Sorry, no copies are available at the moment.</p>
{% endif %}
        
        {% if user_has_borrowed_book %}

        <a href="{% url 'Library:borrowing_list'%}" class="btn btn-outline-secondary">borrowing list</a>
        <a href="{{ book.pdf.url }}" target="_blank" class="btn btn-outline-success"> View PDF</a>

        {% endif %}

        {% endif %}

        {% endif %}
      </div>
    </div>
  </div>
  <a href="{% url 'Library:book_list' %}" class="btn btn-outline-secondary " style="display: block; width: 70px; margin: 20px 0px 0px 50%;" >Back</a>

{% endblock %}
